SELECT i.i_item_id, ca.ca_country, ca.ca_state, ca.ca_county, AVG(cs.cs_quantity) AS avg_quantity_sold, AVG(cs.cs_list_price) AS avg_list_price, AVG(cs.cs_coupon_amt) AS avg_coupon_amount, AVG(cs.cs_sales_price) AS avg_sales_price, AVG(cs.cs_net_profit) AS avg_net_profit, AVG(c.c_birth_year) AS avg_birth_year, COUNT(DISTINCT cp.cp_department) AS department_count FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk WHERE dd.d_year = 2001 AND cd.cd_gender = 'F' AND cd.cd_education_status = 'Secondary' AND ca.ca_state IN ('KS', 'IA', 'AL', 'UT', 'VA', 'NC', 'TX') AND c.c_birth_month IN (8, 4, 2, 5, 11, 9) GROUP BY i.i_item_id, ca.ca_country, ca.ca_state, ca.ca_county ORDER BY ca.ca_country, ca.ca_state, ca.ca_county, i.i_item_id LIMIT 100;
