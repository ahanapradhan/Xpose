WITH sales_data AS ( SELECT i.i_item_id, cs.cs_ext_sales_price AS sales_price FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer_address ca ON cs.cs_bill_addr_sk = ca.ca_address_sk WHERE i.i_color IN ('firebrick', 'rosy', 'white') AND d.d_year = 1998 AND d.d_moy = 3 AND ca.ca_gmt_offset = -6 UNION ALL SELECT i.i_item_id, ss.ss_ext_sales_price AS sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE i.i_color IN ('firebrick', 'rosy', 'white') AND d.d_year = 1998 AND d.d_moy = 3 AND ca.ca_gmt_offset = -6 UNION ALL SELECT i.i_item_id, ws.ws_ext_sales_price AS sales_price FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE i.i_color IN ('firebrick', 'rosy', 'white') AND d.d_year = 1998 AND d.d_moy = 3 AND ca.ca_gmt_offset = -6 ) SELECT i_item_id, SUM(sales_price) AS total_sales FROM sales_data GROUP BY i_item_id ORDER BY total_sales DESC LIMIT 100;
