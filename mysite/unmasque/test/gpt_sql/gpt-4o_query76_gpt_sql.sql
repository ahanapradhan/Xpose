SELECT 'store' AS channel, d.d_year, d.d_qoy, i.i_category, COUNT(ss.ss_ticket_number) AS total_transactions, SUM(ss.ss_net_paid) AS total_sales_amount FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE (ss.ss_cdemo_sk IS NULL OR ss.ss_hdemo_sk IS NULL OR ss.ss_addr_sk IS NULL) GROUP BY d.d_year, d.d_qoy, i.i_category UNION ALL SELECT 'web' AS channel, d.d_year, d.d_qoy, i.i_category, COUNT(ws.ws_order_number) AS total_transactions, SUM(ws.ws_net_paid) AS total_sales_amount FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE (ws.ws_bill_cdemo_sk IS NULL OR ws.ws_bill_hdemo_sk IS NULL OR ws.ws_bill_addr_sk IS NULL) GROUP BY d.d_year, d.d_qoy, i.i_category UNION ALL SELECT 'catalog' AS channel, d.d_year, d.d_qoy, i.i_category, COUNT(cs.cs_order_number) AS total_transactions, SUM(cs.cs_net_paid) AS total_sales_amount FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE (cs.cs_bill_cdemo_sk IS NULL OR cs.cs_bill_hdemo_sk IS NULL OR cs.cs_bill_addr_sk IS NULL) GROUP BY d.d_year, d.d_qoy, i.i_category ORDER BY channel, d_year, d_qoy, i_category LIMIT 100;
