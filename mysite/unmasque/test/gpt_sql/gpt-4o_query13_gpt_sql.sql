SELECT AVG(ss_quantity) AS avg_quantity_sold, AVG(ss_ext_sales_price) AS avg_extended_sales_price, AVG(ss_ext_wholesale_cost) AS avg_extended_wholesale_cost, SUM(ss_ext_wholesale_cost) AS total_extended_wholesale_cost FROM store_sales JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk WHERE date_dim.d_year = 2001 AND customer_demographics.cd_marital_status IN ('Single', 'Married') AND customer_demographics.cd_education_status IN ('College', 'Graduate') AND customer_demographics.cd_dep_count BETWEEN 1 AND 3 AND store_sales.ss_sales_price BETWEEN 100 AND 500 AND customer_address.ca_state IN ('CA', 'NY', 'TX') AND store_sales.ss_net_profit BETWEEN 1000 AND 5000;
