SELECT i.i_product_name, i.i_brand, i.i_class, i.i_category, AVG(inv.inv_quantity_on_hand) AS avg_quantity_on_hand FROM inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk WHERE d.d_date BETWEEN (CURRENT_DATE - INTERVAL '12 months') AND CURRENT_DATE GROUP BY ROLLUP(i.i_product_name, i.i_brand, i.i_class, i.i_category) ORDER BY avg_quantity_on_hand DESC, i.i_product_name, i.i_brand, i.i_class, i.i_category LIMIT 100;
