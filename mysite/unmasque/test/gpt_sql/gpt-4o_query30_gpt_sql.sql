SELECT c.c_customer_id, c.c_first_name, c.c_last_name, c.c_salutation, c.c_preferred_cust_flag, c.c_birth_day, c.c_birth_month, c.c_birth_year, c.c_birth_country, c.c_login, c.c_email_address, c.c_last_review_date_sk, SUM(wr.wr_return_amt) AS total_return_amount FROM customer c JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN date_dim d ON wr.wr_returned_date_sk = d.d_date_sk WHERE ca.ca_state = 'IN' AND d.d_year = 2000 GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_salutation, c.c_preferred_cust_flag, c.c_birth_day, c.c_birth_month, c.c_birth_year, c.c_birth_country, c.c_login, c.c_email_address, c.c_last_review_date_sk HAVING SUM(wr.wr_return_amt) > 1.2 * ( SELECT AVG(wr2.wr_return_amt) FROM web_returns wr2 JOIN customer c2 ON wr2.wr_refunded_customer_sk = c2.c_customer_sk JOIN customer_address ca2 ON c2.c_current_addr_sk = ca2.ca_address_sk JOIN date_dim d2 ON wr2.wr_returned_date_sk = d2.d_date_sk WHERE ca2.ca_state = 'IN' AND d2.d_year = 2000 ) ORDER BY c.c_customer_id, c.c_first_name, c.c_last_name LIMIT 100;
