SELECT i.i_manufact_id, COALESCE(SUM(ss.ss_sales_price), 0) AS total_store_sales, COALESCE(SUM(cs.cs_sales_price), 0) AS total_catalog_sales, COALESCE(SUM(ws.ws_sales_price), 0) AS total_web_sales, COALESCE(SUM(ss.ss_sales_price), 0) + COALESCE(SUM(cs.cs_sales_price), 0) + COALESCE(SUM(ws.ws_sales_price), 0) AS total_sales FROM item i LEFT JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk LEFT JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk LEFT JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk JOIN date_dim d_ss ON ss.ss_sold_date_sk = d_ss.d_date_sk JOIN date_dim d_cs ON cs.cs_sold_date_sk = d_cs.d_date_sk JOIN date_dim d_ws ON ws.ws_sold_date_sk = d_ws.d_date_sk JOIN customer_address ca_ss ON ss.ss_addr_sk = ca_ss.ca_address_sk JOIN customer_address ca_cs ON cs.cs_bill_addr_sk = ca_cs.ca_address_sk JOIN customer_address ca_ws ON ws.ws_bill_addr_sk = ca_ws.ca_address_sk WHERE (d_ss.d_year = 1999 AND d_ss.d_moy = 3 AND ca_ss.ca_gmt_offset = -5) OR (d_cs.d_year = 1999 AND d_cs.d_moy = 3 AND ca_cs.ca_gmt_offset = -5) OR (d_ws.d_year = 1999 AND d_ws.d_moy = 3 AND ca_ws.ca_gmt_offset = -5) GROUP BY i.i_manufact_id ORDER BY total_sales DESC LIMIT 100;
