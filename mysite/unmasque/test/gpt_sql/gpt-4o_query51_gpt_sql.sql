WITH WebSalesCumulative AS ( SELECT ws_item_sk AS item_id, d_date AS sale_date, SUM(ws_net_paid) OVER (PARTITION BY ws_item_sk ORDER BY d_date) AS cumulative_web_sales FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_date BETWEEN '2022-01-01' AND '2022-12-31' ), StoreSalesCumulative AS ( SELECT ss_item_sk AS item_id, d_date AS sale_date, SUM(ss_net_paid) OVER (PARTITION BY ss_item_sk ORDER BY d_date) AS cumulative_store_sales FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_date BETWEEN '2022-01-01' AND '2022-12-31' ) SELECT wsc.item_id, wsc.sale_date, wsc.cumulative_web_sales, ssc.cumulative_store_sales FROM WebSalesCumulative wsc JOIN StoreSalesCumulative ssc ON wsc.item_id = ssc.item_id AND wsc.sale_date = ssc.sale_date WHERE wsc.cumulative_web_sales > ssc.cumulative_store_sales ORDER BY wsc.item_id, wsc.sale_date LIMIT 100;
