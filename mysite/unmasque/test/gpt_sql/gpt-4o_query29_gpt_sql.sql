SELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, AVG(ss.ss_quantity) AS avg_store_sales_quantity, AVG(sr.sr_return_quantity) AS avg_store_return_quantity, AVG(cs.cs_quantity) AS avg_catalog_sales_quantity FROM item i JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk LEFT JOIN store_returns sr ON i.i_item_sk = sr.sr_item_sk AND sr.sr_store_sk = s.s_store_sk AND sr.sr_returned_date_sk = d.d_date_sk LEFT JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk AND cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_year = 1998 AND d.d_moy = 4 GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100;
