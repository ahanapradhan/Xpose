SELECT (SUM(CASE WHEN t_hour = 12 THEN 1 ELSE 0 END) * 1.0 / NULLIF(SUM(CASE WHEN t_hour = 20 THEN 1 ELSE 0 END), 0)) AS ratio FROM web_sales JOIN time_dim ON ws_sold_time_sk = t_time_sk JOIN household_demographics ON ws_bill_hdemo_sk = hd_demo_sk JOIN web_page ON ws_web_page_sk = wp_web_page_sk WHERE hd_dep_count = 8 AND wp_char_count BETWEEN 5000 AND 5200 AND t_hour IN (12, 20) GROUP BY ws_bill_hdemo_sk, ws_web_page_sk ORDER BY ratio DESC LIMIT 100;
