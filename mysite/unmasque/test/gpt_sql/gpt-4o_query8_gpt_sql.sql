SELECT s.s_store_name FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE d.d_year = 2000 AND d.d_qoy = 2 AND c.c_preferred_cust_flag = 'Y' AND LEFT(s.s_zip, 2) = LEFT(ca.ca_zip, 2) GROUP BY s.s_store_name HAVING COUNT(DISTINCT c.c_customer_sk) > 10 ORDER BY SUM(ss.ss_net_profit) DESC, s.s_store_name LIMIT 100;
