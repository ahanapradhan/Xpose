SELECT c.c_customer_id, SUM(ss.ss_net_paid - COALESCE(sr.sr_return_amt, 0)) AS total_sales FROM store_sales ss JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND sr.sr_reason_sk = (SELECT r_reason_sk FROM reason WHERE r_reason_id = 'reason 38') GROUP BY c.c_customer_id ORDER BY total_sales DESC, c.c_customer_id LIMIT 100;
