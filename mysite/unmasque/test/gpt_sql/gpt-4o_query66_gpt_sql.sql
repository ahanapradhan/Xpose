SELECT w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_county, w.w_state, w.w_country, sm.sm_carrier, SUM(cs.cs_ext_sales_price) AS total_sales_1998, SUM(cs.cs_net_paid) AS total_net_sales_1998, SUM(cs.cs_ext_sales_price) / w.w_warehouse_sq_ft AS sales_per_sq_ft_1998, SUM(cs.cs_net_paid) / w.w_warehouse_sq_ft AS net_sales_per_sq_ft_1998 FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk WHERE d.d_year = 1998 AND sm.sm_carrier IN ('ZOUROS', 'ZHOU') GROUP BY w.w_warehouse_name, w.w_warehouse_sq_ft, w.w_city, w.w_county, w.w_state, w.w_country, sm.sm_carrier ORDER BY w.w_warehouse_name LIMIT 100;
