SELECT i.i_category, i.i_class, i.i_brand, s.s_store_name, s.s_company_name, SUM(ss.ss_net_paid) AS total_sales, SUM(ss.ss_net_paid) / 12 AS avg_monthly_sales, ABS(SUM(ss.ss_net_paid) - (SUM(ss.ss_net_paid) / 12)) AS sales_deviation FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE d.d_year = 2002 GROUP BY i.i_category, i.i_class, i.i_brand, s.s_store_name, s.s_company_name HAVING ABS(SUM(ss.ss_net_paid) - (SUM(ss.ss_net_paid) / 12)) > 0.1 * (SUM(ss.ss_net_paid) / 12) ORDER BY sales_deviation DESC, s.s_store_name LIMIT 100;
