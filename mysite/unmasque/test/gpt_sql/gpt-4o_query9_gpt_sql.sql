SELECT CASE WHEN COUNT(*) > 100 THEN AVG(ss_list_price) ELSE AVG(ss_net_profit) END AS average_value, CASE WHEN ss_quantity BETWEEN 1 AND 10 THEN '1-10' WHEN ss_quantity BETWEEN 11 AND 20 THEN '11-20' WHEN ss_quantity BETWEEN 21 AND 30 THEN '21-30' WHEN ss_quantity BETWEEN 31 AND 40 THEN '31-40' ELSE '41+' END AS quantity_range FROM store_sales JOIN store_returns ON store_sales.ss_ticket_number = store_returns.sr_ticket_number JOIN reason ON store_returns.sr_reason_sk = reason.r_reason_sk WHERE reason.r_reason_sk = 1 GROUP BY quantity_range;
