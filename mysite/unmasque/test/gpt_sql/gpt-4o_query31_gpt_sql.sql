WITH web_sales_growth AS ( SELECT ca_county, SUM(CASE WHEN d_quarter_seq = 1 THEN ws_net_paid ELSE 0 END) AS q1_sales, SUM(CASE WHEN d_quarter_seq = 2 THEN ws_net_paid ELSE 0 END) AS q2_sales, SUM(CASE WHEN d_quarter_seq = 3 THEN ws_net_paid ELSE 0 END) AS q3_sales FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_bill_addr_sk = ca_address_sk WHERE d_year = 2001 GROUP BY ca_county ), store_sales_growth AS ( SELECT s_county, SUM(CASE WHEN d_quarter_seq = 1 THEN ss_net_paid ELSE 0 END) AS q1_sales, SUM(CASE WHEN d_quarter_seq = 2 THEN ss_net_paid ELSE 0 END) AS q2_sales, SUM(CASE WHEN d_quarter_seq = 3 THEN ss_net_paid ELSE 0 END) AS q3_sales FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE d_year = 2001 GROUP BY s_county ) SELECT w.ca_county FROM web_sales_growth w JOIN store_sales_growth s ON w.ca_county = s.s_county WHERE (w.q2_sales - w.q1_sales) / NULLIF(w.q1_sales, 0) > (s.q2_sales - s.q1_sales) / NULLIF(s.q1_sales, 0) AND (w.q3_sales - w.q2_sales) / NULLIF(w.q2_sales, 0) > (s.q3_sales - s.q2_sales) / NULLIF(s.q2_sales, 0);
