SELECT COUNT(CASE WHEN ss_promo_sk IS NOT NULL THEN 1 END) AS promo_sales_count, COUNT(*) AS total_sales_count, COUNT(CASE WHEN ss_promo_sk IS NOT NULL THEN 1 END) * 1.0 / COUNT(*) AS promo_sales_ratio FROM store_sales JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk JOIN item ON store_sales.ss_item_sk = item.i_item_sk WHERE date_dim.d_year = ? AND date_dim.d_moy = ? AND store.s_gmt_offset = ? AND item.i_category IN (?);
