SELECT c.c_customer_id FROM customer c JOIN ( SELECT ss_customer_sk AS customer_sk, SUM(ss_net_paid) AS total_store_spent FROM store_sales GROUP BY ss_customer_sk ) store_spending ON c.c_customer_sk = store_spending.customer_sk JOIN ( SELECT ws_bill_customer_sk AS customer_sk, SUM(ws_net_paid) AS total_web_spent FROM web_sales GROUP BY ws_bill_customer_sk ) web_spending ON c.c_customer_sk = web_spending.customer_sk WHERE web_spending.total_web_spent > store_spending.total_store_spent; SELECT i.i_item_id, SUM(total_returns) AS total_returns FROM ( SELECT sr_item_sk AS item_sk, SUM(sr_return_quantity) AS total_returns FROM store_returns WHERE sr_returned_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-11-11') AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-11-17') GROUP BY sr_item_sk UNION ALL SELECT cr_item_sk AS item_sk, SUM(cr_return_quantity) AS total_returns FROM catalog_returns WHERE cr_returned_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-11-11') AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-11-17') GROUP BY cr_item_sk UNION ALL SELECT wr_item_sk AS item_sk, SUM(wr_return_quantity) AS total_returns FROM web_returns WHERE wr_returned_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-11-11') AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2000-11-17') GROUP BY wr_item_sk ) returns JOIN item i ON returns.item_sk = i.i_item_sk GROUP BY i.i_item_id HAVING MAX(total_returns) - MIN(total_returns) <= 0.1 * MAX(total_returns) ORDER BY total_returns DESC LIMIT 1; SELECT c.c_customer_id FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN income_band ib ON hd.hd_income_band_sk = ib.ib_income_band_sk WHERE ca.ca_city = 'Edgewood' AND ib.ib_lower_bound >= 38128 AND ib.ib_upper_bound <= 50000; SELECT cd.cd_marital_status, cd.cd_education_status, ca.ca_state, AVG(ws.ws_net_paid) AS avg_sales, AVG(wr.wr_refunded_cash) AS avg_refunded_cash, AVG(wr.wr_fee) AS avg_return_fee FROM web_sales ws JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk GROUP BY cd.cd_marital_status, cd.cd_education_status, ca.ca_state;
