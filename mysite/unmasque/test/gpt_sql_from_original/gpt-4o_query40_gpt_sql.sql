SELECT w.w_warehouse_id, SUM(CASE WHEN d.d_date BETWEEN DATE '2000-02-10' AND DATE '2000-03-10' THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_before_change, SUM(CASE WHEN d.d_date BETWEEN DATE '2000-03-11' AND DATE '2000-04-10' THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_after_change FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE d.d_date BETWEEN DATE '2000-02-10' AND DATE '2000-04-10' GROUP BY w.w_warehouse_id;
