SELECT w.w_warehouse_name, SUM(CASE WHEN d.d_date BETWEEN DATE '2002-05-02' AND DATE '2002-05-31' THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_before_change, SUM(CASE WHEN d.d_date BETWEEN DATE '2002-06-01' AND DATE '2002-06-30' THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_after_change FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE d.d_date BETWEEN DATE '2002-05-02' AND DATE '2002-06-30' GROUP BY w.w_warehouse_name;
