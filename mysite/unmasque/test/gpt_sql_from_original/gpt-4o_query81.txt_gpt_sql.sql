SELECT c.* FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_returning_customer_sk JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk WHERE ca.ca_state = 'given_state' AND d.d_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY c.c_customer_sk, c.c_customer_id, c.c_current_cdemo_sk, c.c_current_hdemo_sk, c.c_current_addr_sk, c.c_first_shipto_date_sk, c.c_first_sales_date_sk, c.c_salutation, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag, c.c_birth_day, c.c_birth_month, c.c_birth_year, c.c_birth_country, c.c_login, c.c_email_address, c.c_last_review_date_sk HAVING SUM(cr.cr_return_quantity) > 1.2 * ( SELECT AVG(total_returns) FROM ( SELECT SUM(cr2.cr_return_quantity) AS total_returns FROM catalog_returns cr2 JOIN customer c2 ON cr2.cr_returning_customer_sk = c2.c_customer_sk JOIN customer_address ca2 ON c2.c_current_addr_sk = ca2.ca_address_sk JOIN date_dim d2 ON cr2.cr_returned_date_sk = d2.d_date_sk WHERE ca2.ca_state = 'given_state' AND d2.d_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY c2.c_customer_sk ) AS avg_returns ) ORDER BY c.c_customer_sk, c.c_customer_id, c.c_current_cdemo_sk, c.c_current_hdemo_sk, c.c_current_addr_sk, c.c_first_shipto_date_sk, c.c_first_sales_date_sk, c.c_salutation, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag, c.c_birth_day, c.c_birth_month, c.c_birth_year, c.c_birth_country, c.c_login, c.c_email_address, c.c_last_review_date_sk;
