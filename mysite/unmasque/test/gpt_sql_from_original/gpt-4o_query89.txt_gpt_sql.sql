SELECT d.d_moy AS month, i.i_category, i.i_class, i.i_brand FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE d.d_year = (SELECT DISTINCT d_year FROM date_dim WHERE d_date_sk = cs.cs_sold_date_sk) GROUP BY d.d_moy, i.i_category, i.i_class, i.i_brand, d.d_year HAVING SUM(cs.cs_ext_sales_price) > 0.001 * ( SELECT SUM(cs_ext_sales_price) FROM catalog_sales cs_total JOIN date_dim d_total ON cs_total.cs_sold_date_sk = d_total.d_date_sk WHERE d_total.d_year = d.d_year ) ORDER BY d.d_moy, i.i_category, i.i_class, i.i_brand;
