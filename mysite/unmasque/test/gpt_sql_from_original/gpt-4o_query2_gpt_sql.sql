SELECT d1.d_week_seq AS week_seq, d1.d_day_name AS day_name, SUM(CASE WHEN d1.d_year = 2022 THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_2022, SUM(CASE WHEN d2.d_year = 2023 THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_2023, SUM(CASE WHEN d2.d_year = 2023 THEN cs.cs_ext_sales_price ELSE 0 END) - SUM(CASE WHEN d1.d_year = 2022 THEN cs.cs_ext_sales_price ELSE 0 END) AS sales_increase FROM catalog_sales cs JOIN date_dim d1 ON cs.cs_sold_date_sk = d1.d_date_sk JOIN date_dim d2 ON d1.d_same_day_ly = d2.d_date_sk WHERE d1.d_year = 2022 AND d2.d_year = 2023 GROUP BY d1.d_week_seq, d1.d_day_name ORDER BY d1.d_week_seq, d1.d_day_name;
