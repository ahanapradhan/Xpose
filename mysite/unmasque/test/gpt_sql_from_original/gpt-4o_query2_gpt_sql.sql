SELECT d1.d_week_seq AS week_seq, SUM(CASE WHEN d1.d_year = 2001 THEN cs1.cs_ext_sales_price ELSE 0 END) AS sales_2001, SUM(CASE WHEN d1.d_year = 2002 THEN cs2.cs_ext_sales_price ELSE 0 END) AS sales_2002, SUM(CASE WHEN d1.d_year = 2002 THEN cs2.cs_ext_sales_price ELSE 0 END) - SUM(CASE WHEN d1.d_year = 2001 THEN cs1.cs_ext_sales_price ELSE 0 END) AS sales_increase FROM date_dim d1 LEFT JOIN catalog_sales cs1 ON d1.d_date_sk = cs1.cs_sold_date_sk LEFT JOIN catalog_sales cs2 ON d1.d_date_sk = cs2.cs_sold_date_sk WHERE d1.d_year IN (2001, 2002) GROUP BY d1.d_week_seq ORDER BY d1.d_week_seq;
