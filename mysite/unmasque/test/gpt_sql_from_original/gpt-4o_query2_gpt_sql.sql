SELECT d1.d_week_seq AS week_sequence, d1.d_day_name AS day_name, SUM(ws1.ws_net_paid) AS web_sales_current_year, SUM(cs1.cs_net_paid) AS catalog_sales_current_year, SUM(ws2.ws_net_paid) AS web_sales_next_year, SUM(cs2.cs_net_paid) AS catalog_sales_next_year, (SUM(ws2.ws_net_paid) - SUM(ws1.ws_net_paid)) AS web_sales_increase, (SUM(cs2.cs_net_paid) - SUM(cs1.cs_net_paid)) AS catalog_sales_increase FROM date_dim d1 JOIN web_sales ws1 ON d1.d_date_sk = ws1.ws_sold_date_sk JOIN catalog_sales cs1 ON d1.d_date_sk = cs1.cs_sold_date_sk JOIN date_dim d2 ON d1.d_same_day_ly = d2.d_date_sk JOIN web_sales ws2 ON d2.d_date_sk = ws2.ws_sold_date_sk JOIN catalog_sales cs2 ON d2.d_date_sk = cs2.cs_sold_date_sk WHERE d1.d_year = 1998 GROUP BY d1.d_week_seq, d1.d_day_name ORDER BY d1.d_week_seq, d1.d_day_name;
