SELECT l_returnflag, l_linestatus,
SUM(l_extendedprice) AS total_extended_price, SUM(l_extendedprice * (1 - l_discount)) AS total_discounted_extended_price, SUM(l_extendedprice * (1 - l_discount) * (1 + l_tax)) AS total_discounted_extended_price_plus_tax, AVG(l_quantity) AS avg_quantity, AVG(l_extendedprice) AS avg_extended_price, AVG(l_discount) AS avg_discount, COUNT(*) AS lineitem_count FROM lineitem WHERE l_shipdate <= (SELECT MAX(l_shipdate) - INTERVAL '60' DAY FROM lineitem) AND l_shipdate >= (SELECT MAX(l_shipdate) - INTERVAL '120' DAY FROM lineitem) GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag, l_linestatus;
