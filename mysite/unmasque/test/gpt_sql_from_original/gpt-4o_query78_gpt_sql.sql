SELECT ss.ss_customer_sk, ss.ss_item_sk, (SUM(ss.ss_net_paid) / (SUM(cs.cs_net_paid) + SUM(ws.ws_net_paid))) AS sales_ratio FROM store_sales ss JOIN catalog_sales cs ON ss.ss_customer_sk = cs.cs_bill_customer_sk AND ss.ss_item_sk = cs.cs_item_sk JOIN web_sales ws ON ss.ss_customer_sk = ws.ws_bill_customer_sk AND ss.ss_item_sk = ws.ws_item_sk GROUP BY ss.ss_customer_sk, ss.ss_item_sk HAVING SUM(ss.ss_net_paid) > 0 AND (SUM(cs.cs_net_paid) + SUM(ws.ws_net_paid)) > 0 AND (SUM(ss.ss_net_paid) / (SUM(cs.cs_net_paid) + SUM(ws.ws_net_paid))) >= 2 ORDER BY sales_ratio DESC;
