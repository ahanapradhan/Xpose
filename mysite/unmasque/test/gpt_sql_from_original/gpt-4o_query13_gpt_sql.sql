SELECT cd.cd_marital_status, cd.cd_education_status, ca.ca_state, AVG(ss.ss_quantity) AS avg_sales_quantity, AVG(ss.ss_sales_price) AS avg_sales_price, AVG(ss.ss_wholesale_cost) AS avg_wholesale_cost, SUM(ss.ss_wholesale_cost) AS total_wholesale_cost FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk WHERE dd.d_year = 2023 AND ca.ca_state IN ('TX', 'OH', 'OR', 'NM', 'KY', 'VA', 'MS') AND cd.cd_education_status IN ('Advanced Degree', 'College', '2 yr Degree') AND cd.cd_marital_status IN ('M', 'S', 'W') GROUP BY cd.cd_marital_status, cd.cd_education_status, ca.ca_state;
