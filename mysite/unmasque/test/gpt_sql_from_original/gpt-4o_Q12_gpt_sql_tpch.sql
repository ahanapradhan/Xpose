SELECT l_shipmode, SUM(CASE WHEN o_orderpriority IN ('URGENT', 'HIGH') THEN 1 ELSE 0 END) AS high_priority_count, SUM(CASE WHEN o_orderpriority NOT IN ('URGENT', 'HIGH') THEN 1 ELSE 0 END) AS other_priority_count FROM lineitem JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE l_receiptdate > l_commitdate AND l_shipdate < l_commitdate AND EXTRACT(YEAR FROM l_receiptdate) = 2022 AND l_shipmode IN ('SHIP_MODE_1', 'SHIP_MODE_2') GROUP BY l_shipmode;
