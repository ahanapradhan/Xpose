SELECT d.d_moy AS month, i.i_category AS category, i.i_class AS class, i.i_brand AS brand FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE d.d_year = 2023 GROUP BY d.d_moy, i.i_category, i.i_class, i.i_brand HAVING SUM(cs.cs_ext_sales_price) > 0.001 * (SELECT SUM(cs_ext_sales_price) FROM catalog_sales WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2023)) ORDER BY month, category, class, brand;
