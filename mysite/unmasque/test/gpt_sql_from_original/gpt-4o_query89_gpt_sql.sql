SELECT d.d_moy AS month, i.i_category AS category, i.i_class AS class, i.i_brand AS brand, SUM(cs.cs_ext_sales_price) AS monthly_sales FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk WHERE d.d_year = 1999 GROUP BY d.d_moy, i.i_category, i.i_class, i.i_brand HAVING SUM(cs.cs_ext_sales_price) > ( 0.001 * ( SELECT SUM(cs_inner.cs_ext_sales_price) FROM catalog_sales cs_inner JOIN date_dim d_inner ON cs_inner.cs_sold_date_sk = d_inner.d_date_sk WHERE d_inner.d_year = 1999 ) ) ORDER BY month, category, class, brand;
