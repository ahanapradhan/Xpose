SELECT cd.cd_marital_status, cd.cd_education_status, ca.ca_state, SUM(cs.cs_sales_price) AS total_sales, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk WHERE cd.cd_marital_status IN ('M', 'D', 'S') AND cd.cd_education_status IN ('4 yr Degree', '2 yr Degree', 'College') AND ca.ca_state IN ('CO', 'OH', 'TX', 'OR', 'MN', 'KY', 'VA', 'CA', 'MS') AND dd.d_year = 2000 GROUP BY cd.cd_marital_status, cd.cd_education_status, ca.ca_state ORDER BY total_sales DESC;
