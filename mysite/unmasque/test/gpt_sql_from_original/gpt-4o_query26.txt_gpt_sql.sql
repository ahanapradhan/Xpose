SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, AVG(cs.cs_quantity) AS avg_quantity, AVG(cs.cs_list_price) AS avg_list_price, AVG(cs.cs_ext_discount_amt / NULLIF(cs.cs_quantity, 0)) AS avg_discount, AVG(cs.cs_sales_price) AS avg_sales_price FROM catalog_sales cs JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk JOIN customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk WHERE p.p_channel_catalog = 'Y' AND p.p_channel_dmail = 'N' AND p.p_channel_event = 'N' GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
