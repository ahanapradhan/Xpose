SELECT COUNT(*) AS web_sales_count, SUM(ws_ext_ship_cost) AS total_shipping_cost, SUM(ws_net_profit) AS total_net_profit FROM web_sales ws JOIN customer_address ca ON ws.ws_ship_addr_sk = ca.ca_address_sk JOIN web_site w ON ws.ws_web_site_sk = w.web_site_sk JOIN (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1) multi_warehouse_orders ON ws.ws_order_number = multi_warehouse_orders.ws_order_number WHERE ca.ca_state = 'CA' -- Replace 'CA' with the desired state AND w.web_name = 'ExampleSite' -- Replace 'ExampleSite' with the desired web site name AND ws.ws_sold_date_sk BETWEEN (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-01-01') -- Replace with start date AND (SELECT d_date_sk FROM date_dim WHERE d_date = '2023-03-01') -- Replace with end date AND ws.ws_order_number NOT IN (SELECT wr_order_number FROM web_returns);
