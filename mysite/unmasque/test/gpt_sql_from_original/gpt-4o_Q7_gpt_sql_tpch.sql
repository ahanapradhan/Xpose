SELECT s_nation.n_name AS supplier_nation, c_nation.n_name AS customer_nation, EXTRACT(YEAR FROM l_shipdate) AS year, SUM(l_extendedprice * (1 - l_discount)) AS revenue FROM lineitem JOIN orders ON lineitem.l_orderkey = orders.o_orderkey JOIN customer ON orders.o_custkey = customer.c_custkey JOIN nation c_nation ON customer.c_nationkey = c_nation.n_nationkey JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey JOIN nation s_nation ON supplier.s_nationkey = s_nation.n_nationkey WHERE ((s_nation.n_name = 'Nation1' AND c_nation.n_name = 'Nation2') OR (s_nation.n_name = 'Nation2' AND c_nation.n_name = 'Nation1')) AND l_shipdate BETWEEN '1995-01-01' AND '1996-12-31' GROUP BY s_nation.n_name, c_nation.n_name, EXTRACT(YEAR FROM l_shipdate) ORDER BY supplier_nation, customer_nation, year;
