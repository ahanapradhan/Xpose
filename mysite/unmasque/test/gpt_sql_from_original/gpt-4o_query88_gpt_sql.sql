SELECT SUM(CASE WHEN t_hour = 8 AND t_minute BETWEEN 30 AND 59 THEN ss_quantity ELSE 0 END) AS "8:30-9:00", SUM(CASE WHEN t_hour = 9 AND t_minute BETWEEN 0 AND 29 THEN ss_quantity ELSE 0 END) AS "9:00-9:30", SUM(CASE WHEN t_hour = 9 AND t_minute BETWEEN 30 AND 59 THEN ss_quantity ELSE 0 END) AS "9:30-10:00", SUM(CASE WHEN t_hour = 10 AND t_minute BETWEEN 0 AND 29 THEN ss_quantity ELSE 0 END) AS "10:00-10:30", SUM(CASE WHEN t_hour = 10 AND t_minute BETWEEN 30 AND 59 THEN ss_quantity ELSE 0 END) AS "10:30-11:00", SUM(CASE WHEN t_hour = 11 AND t_minute BETWEEN 0 AND 29 THEN ss_quantity ELSE 0 END) AS "11:00-11:30", SUM(CASE WHEN t_hour = 11 AND t_minute BETWEEN 30 AND 59 THEN ss_quantity ELSE 0 END) AS "11:30-12:00", SUM(CASE WHEN t_hour = 12 AND t_minute BETWEEN 0 AND 29 THEN ss_quantity ELSE 0 END) AS "12:00-12:30" FROM store_sales JOIN time_dim ON store_sales.ss_sold_time_sk = time_dim.t_time_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk JOIN customer_demographics ON customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk JOIN household_demographics ON customer.c_current_hdemo_sk = household_demographics.hd_demo_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk WHERE store.s_store_id = 'Unknown' AND ( (cd_dep_count = 1 AND hd_vehicle_count <= 2) OR (cd_dep_count = 2 AND hd_vehicle_count <= 4) OR (cd_dep_count = 3 AND hd_vehicle_count <= 5) ) AND t_hour BETWEEN 8 AND 12 AND t_minute BETWEEN 0 AND 59;
