SELECT s.s_suppkey, s.s_name, SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE EXTRACT(YEAR FROM o.o_orderdate) = 2023 AND EXTRACT(QUARTER FROM o.o_orderdate) = 2 GROUP BY s.s_suppkey, s.s_name HAVING SUM(l.l_extendedprice * (1 - l.l_discount)) = ( SELECT MAX(total_revenue) FROM ( SELECT SUM(l.l_extendedprice * (1 - l.l_discount)) AS total_revenue FROM supplier s JOIN lineitem l ON s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE EXTRACT(YEAR FROM o.o_orderdate) = 2023 AND EXTRACT(QUARTER FROM o.o_orderdate) = 2 GROUP BY s.s_suppkey ) AS revenue_per_supplier ) ORDER BY s.s_suppkey;
