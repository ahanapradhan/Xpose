SELECT i.i_item_id, i.i_product_name, profits.best_net_profit, profits.worst_net_profit FROM ( SELECT item_sk, MAX(profit) AS best_net_profit, MIN(profit) AS worst_net_profit FROM ( SELECT cs_item_sk AS item_sk, SUM(cs_net_profit) AS profit FROM catalog_sales GROUP BY cs_item_sk UNION ALL SELECT ss_item_sk AS item_sk, SUM(ss_net_profit) AS profit FROM store_sales GROUP BY ss_item_sk UNION ALL SELECT ws_item_sk AS item_sk, SUM(ws_net_profit) AS profit FROM web_sales GROUP BY ws_item_sk ) AS combined_sales GROUP BY item_sk ) AS profits JOIN item i ON profits.item_sk = i.i_item_sk ORDER BY profits.best_net_profit DESC, profits.worst_net_profit ASC LIMIT 1;
