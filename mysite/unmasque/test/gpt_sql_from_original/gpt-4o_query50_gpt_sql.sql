SELECT s.s_store_id, SUM(CASE WHEN (d.d_date - (SELECT d2.d_date FROM date_dim d2 WHERE d2.d_date_sk = cs.cs_sold_date_sk)) BETWEEN 31 AND 60 THEN 1 ELSE 0 END) AS returned_31_60_days, SUM(CASE WHEN (d.d_date - (SELECT d2.d_date FROM date_dim d2 WHERE d2.d_date_sk = cs.cs_sold_date_sk)) BETWEEN 61 AND 90 THEN 1 ELSE 0 END) AS returned_61_90_days, SUM(CASE WHEN (d.d_date - (SELECT d2.d_date FROM date_dim d2 WHERE d2.d_date_sk = cs.cs_sold_date_sk)) BETWEEN 91 AND 120 THEN 1 ELSE 0 END) AS returned_91_120_days, SUM(CASE WHEN (d.d_date - (SELECT d2.d_date FROM date_dim d2 WHERE d2.d_date_sk = cs.cs_sold_date_sk)) > 120 THEN 1 ELSE 0 END) AS returned_over_120_days FROM catalog_returns cr JOIN catalog_sales cs ON cr.cr_order_number = cs.cs_order_number JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk JOIN store s ON cs.cs_call_center_sk = s.s_store_sk WHERE d.d_moy = 9 AND d.d_year = 2002 GROUP BY s.s_store_id;
