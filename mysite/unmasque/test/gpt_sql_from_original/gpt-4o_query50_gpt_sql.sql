SELECT s.s_store_id, SUM(CASE WHEN d.d_date_sk - ss.ss_sold_date_sk BETWEEN 31 AND 60 THEN 1 ELSE 0 END) AS returned_31_60_days, SUM(CASE WHEN d.d_date_sk - ss.ss_sold_date_sk BETWEEN 61 AND 90 THEN 1 ELSE 0 END) AS returned_61_90_days, SUM(CASE WHEN d.d_date_sk - ss.ss_sold_date_sk BETWEEN 91 AND 120 THEN 1 ELSE 0 END) AS returned_91_120_days, SUM(CASE WHEN d.d_date_sk - ss.ss_sold_date_sk > 120 THEN 1 ELSE 0 END) AS returned_over_120_days FROM store_returns sr JOIN store_sales ss ON sr.sr_ticket_number = ss.ss_ticket_number AND sr.sr_item_sk = ss.ss_item_sk JOIN date_dim d ON sr.sr_returned_date_sk = d.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE d.d_moy = 8 AND d.d_year = 2001 GROUP BY s.s_store_id;
