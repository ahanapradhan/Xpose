SELECT i.i_item_id, SUM(ss.ss_net_profit) / SUM(ss.ss_ext_sales_price) AS gross_profit_margin FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE d.d_year = 2001 AND ca.ca_state IN ('TN') GROUP BY i.i_item_id ORDER BY gross_profit_margin DESC;
