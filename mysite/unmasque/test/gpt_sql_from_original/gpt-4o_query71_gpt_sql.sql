SELECT i.i_product_name, SUM(cs.cs_ext_sales_price + ss.ss_ext_sales_price + ws.ws_ext_sales_price) AS total_revenue FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk WHERE d.d_month_seq = 202309 AND t.t_meal_time IN ('breakfast', 'dinner') AND (cs.cs_call_center_sk IN (SELECT cc_call_center_sk FROM call_center WHERE cc_manager = 'John Doe') OR ss.ss_store_sk IN (SELECT s_store_sk FROM store WHERE s_manager = 'John Doe') OR ws.ws_web_site_sk IN (SELECT web_site_sk FROM web_site WHERE web_manager = 'John Doe')) GROUP BY i.i_product_name ORDER BY total_revenue DESC;
