SELECT i.i_item_id, i.i_product_name, SUM(cs.cs_ext_sales_price + ss.ss_ext_sales_price + ws.ws_ext_sales_price) AS total_revenue FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk AND ss.ss_sold_date_sk = d.d_date_sk AND ws.ws_sold_date_sk = d.d_date_sk JOIN time_dim t ON cs.cs_sold_time_sk = t.t_time_sk AND ss.ss_sold_time_sk = t.t_time_sk AND ws.ws_sold_time_sk = t.t_time_sk WHERE i.i_manager_id = 1 AND d.d_month_seq = 11 AND d.d_year = 1999 AND t.t_meal_time IN ('breakfast', 'dinner') GROUP BY i.i_item_id, i.i_product_name ORDER BY total_revenue DESC;
