SELECT 'Store' AS sales_channel, s.s_store_name AS sales_method, SUM(ss.ss_ext_sales_price) AS sales, SUM(ss.ss_net_profit) AS profit, SUM(sr.sr_return_amt) AS return_amount, SUM(sr.sr_net_loss) AS net_loss FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk LEFT JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN CURRENT_DATE - INTERVAL '14 days' AND CURRENT_DATE GROUP BY sales_channel, sales_method UNION ALL SELECT 'Catalog' AS sales_channel, cp.cp_description AS sales_method, SUM(cs.cs_ext_sales_price) AS sales, SUM(cs.cs_net_profit) AS profit, SUM(cr.cr_return_amount) AS return_amount, SUM(cr.cr_net_loss) AS net_loss FROM catalog_sales cs JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk LEFT JOIN catalog_returns cr ON cs.cs_item_sk = cr.cr_item_sk AND cs.cs_order_number = cr.cr_order_number JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN CURRENT_DATE - INTERVAL '14 days' AND CURRENT_DATE GROUP BY sales_channel, sales_method UNION ALL SELECT 'Web' AS sales_channel, wp.wp_type AS sales_method, SUM(ws.ws_ext_sales_price) AS sales, SUM(ws.ws_net_profit) AS profit, SUM(wr.wr_return_amt) AS return_amount, SUM(wr.wr_net_loss) AS net_loss FROM web_sales ws JOIN web_page wp ON ws.ws_web_page_sk = wp.wp_web_page_sk LEFT JOIN web_returns wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN CURRENT_DATE - INTERVAL '14 days' AND CURRENT_DATE GROUP BY sales_channel, sales_method;
