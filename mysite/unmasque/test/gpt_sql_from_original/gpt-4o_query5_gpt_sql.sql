SELECT 'Store' AS sales_channel, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit, SUM(sr_return_amt) AS return_amount, SUM(sr_net_loss) AS net_loss FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk LEFT JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number WHERE d_date BETWEEN '2000-08-23' AND '2000-09-05' GROUP BY sales_channel UNION ALL SELECT 'Catalog' AS sales_channel, SUM(cs_ext_sales_price) AS sales, SUM(cs_net_profit) AS profit, SUM(cr_return_amount) AS return_amount, SUM(cr_net_loss) AS net_loss FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number WHERE d_date BETWEEN '2000-08-23' AND '2000-09-05' GROUP BY sales_channel UNION ALL SELECT 'Web' AS sales_channel, SUM(ws_ext_sales_price) AS sales, SUM(ws_net_profit) AS profit, SUM(wr_return_amt) AS return_amount, SUM(wr_net_loss) AS net_loss FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk LEFT JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number WHERE d_date BETWEEN '2000-08-23' AND '2000-09-05' GROUP BY sales_channel;
