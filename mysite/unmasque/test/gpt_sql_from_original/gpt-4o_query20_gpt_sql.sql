SELECT SUM(cs.cs_net_paid) AS total_revenue, i.i_class, SUM(cs.cs_net_paid) / NULLIF(SUM(SUM(cs.cs_net_paid)) OVER (PARTITION BY i.i_class), 0) AS revenue_ratio FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE i.i_category IN ('Sports', 'Books', 'Home') AND d.d_date BETWEEN '1999-02-22' AND '1999-12-31' GROUP BY i.i_class;
