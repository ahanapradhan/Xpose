SELECT SUM(cs.cs_net_paid_inc_tax + ss.ss_net_paid_inc_tax + ws.ws_net_paid_inc_tax) AS total_revenue, i.i_class, SUM(cs.cs_net_paid_inc_tax + ss.ss_net_paid_inc_tax + ws.ws_net_paid_inc_tax) / NULLIF(SUM(SUM(cs.cs_net_paid_inc_tax + ss.ss_net_paid_inc_tax + ws.ws_net_paid_inc_tax)) OVER (PARTITION BY i.i_class), 0) AS revenue_ratio FROM item i JOIN catalog_sales cs ON i.i_item_sk = cs.cs_item_sk JOIN store_sales ss ON i.i_item_sk = ss.ss_item_sk JOIN web_sales ws ON i.i_item_sk = ws.ws_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE i.i_category IN ('Category1', 'Category2') AND d.d_date BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY i.i_class;
