SELECT w.w_warehouse_id, SUM(CASE WHEN d.d_date BETWEEN DATE '2000-02-10' AND DATE '2000-03-10' THEN cs.cs_sales_price ELSE 0 END) AS sales_before_change, SUM(CASE WHEN d.d_date BETWEEN DATE '2000-03-11' AND DATE '2000-04-10' THEN cs.cs_sales_price ELSE 0 END) AS sales_after_change FROM catalog_sales cs JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk WHERE d.d_date BETWEEN DATE '2000-02-10' AND DATE '2000-04-10' GROUP BY w.w_warehouse_id; SELECT COUNT(*) AS item_count FROM item WHERE i_manufact_id = 738 AND i_size IN ('medium', 'extra large', 'N/A', 'small', 'petite', 'large') AND i_units IN ('Ounce', 'Oz', 'Bunch', 'Ton', 'N/A', 'Dozen', 'Box', 'Pound', 'Pallet', 'Gross', 'Cup', 'Dram', 'Each', 'Tbl', 'Lb', 'Bundle') AND i_color IN ('powder', 'khaki', 'brown', 'honeydew', 'floral', 'deep', 'light', 'cornflower', 'midnight', 'snow', 'cyan', 'papaya', 'orange', 'frosted', 'forest', 'ghost'); SELECT ss_item_sk, SUM(ss_ext_sales_price) AS total_ext_sales_price FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2000 AND d.d_moy = 3 GROUP BY ss_item_sk;
