SELECT d1.d_week_seq AS week_seq, d1.d_day_name AS day_name, SUM(CASE WHEN d1.d_year = d2.d_year + 1 THEN cs.cs_net_paid ELSE 0 END) - SUM(CASE WHEN d1.d_year = d2.d_year THEN cs.cs_net_paid ELSE 0 END) AS catalog_sales_increase, SUM(CASE WHEN d1.d_year = d2.d_year + 1 THEN ws.ws_net_paid ELSE 0 END) - SUM(CASE WHEN d1.d_year = d2.d_year THEN ws.ws_net_paid ELSE 0 END) AS web_sales_increase FROM date_dim d1 JOIN date_dim d2 ON d1.d_date_sk = d2.d_same_day_ly LEFT JOIN catalog_sales cs ON d1.d_date_sk = cs.cs_sold_date_sk LEFT JOIN web_sales ws ON d1.d_date_sk = ws.ws_sold_date_sk GROUP BY d1.d_week_seq, d1.d_day_name ORDER BY d1.d_week_seq, d1.d_day_name;
