SELECT 'store' AS sales_channel, SUM(ss_ext_sales_price) AS extended_sales, SUM(ss_net_profit) AS extended_net_profit, SUM(sr_return_amt) AS returns FROM store_sales JOIN item ON ss_item_sk = i_item_sk LEFT JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE i_current_price > 50 AND ss_promo_sk IS NULL AND d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY sales_channel UNION ALL SELECT 'catalog' AS sales_channel, SUM(cs_ext_sales_price) AS extended_sales, SUM(cs_net_profit) AS extended_net_profit, SUM(cr_return_amount) AS returns FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk LEFT JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE i_current_price > 50 AND cs_promo_sk IS NULL AND d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY sales_channel UNION ALL SELECT 'web' AS sales_channel, SUM(ws_ext_sales_price) AS extended_sales, SUM(ws_net_profit) AS extended_net_profit, SUM(wr_return_amt) AS returns FROM web_sales JOIN item ON ws_item_sk = i_item_sk LEFT JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE i_current_price > 50 AND ws_promo_sk IS NULL AND d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY sales_channel;
