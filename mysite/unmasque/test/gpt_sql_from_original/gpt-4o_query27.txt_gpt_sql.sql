SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, AVG(ss.ss_quantity) AS avg_quantity, AVG(ss.ss_list_price) AS avg_list_price, AVG(ss.ss_sales_price) AS avg_sales_price, AVG(ss.ss_coupon_amt) AS avg_coupon_amount FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk WHERE dd.d_year = ? -- given year AND s.s_state IN (?, ?, ?, ?, ?, ?) -- six states GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status;
