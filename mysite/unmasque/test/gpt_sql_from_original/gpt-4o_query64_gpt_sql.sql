SELECT s.s_store_id FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk JOIN catalog_sales cs ON ss.ss_item_sk = cs.cs_item_sk JOIN web_sales ws ON cs.cs_item_sk = ws.ws_item_sk JOIN date_dim d1 ON ss.ss_sold_date_sk = d1.d_date_sk JOIN date_dim d2 ON cs.cs_sold_date_sk = d2.d_date_sk JOIN date_dim d3 ON ws.ws_sold_date_sk = d3.d_date_sk WHERE d1.d_year = 2022 AND d2.d_year = 2022 AND d3.d_year = 2022 GROUP BY s.s_store_id HAVING SUM(ss.ss_quantity) + SUM(cs.cs_quantity) + SUM(ws.ws_quantity) > ( SELECT SUM(ss2.ss_quantity) + SUM(cs2.cs_quantity) + SUM(ws2.ws_quantity) FROM store_sales ss2 JOIN catalog_sales cs2 ON ss2.ss_item_sk = cs2.cs_item_sk JOIN web_sales ws2 ON cs2.cs_item_sk = ws2.ws_item_sk JOIN date_dim d4 ON ss2.ss_sold_date_sk = d4.d_date_sk JOIN date_dim d5 ON cs2.cs_sold_date_sk = d5.d_date_sk JOIN date_dim d6 ON ws2.ws_sold_date_sk = d6.d_date_sk WHERE ss2.ss_store_sk = s.s_store_sk AND d4.d_year = 2021 AND d5.d_year = 2021 AND d6.d_year = 2021 GROUP BY ss2.ss_store_sk );
