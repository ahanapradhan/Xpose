SELECT s.s_store_id FROM store_sales ss JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001 AND i.i_current_price > 58 AND i.i_color IN ('cyan', 'peach', 'blush', 'frosted', 'powder', 'orange') GROUP BY s.s_store_id HAVING SUM(ss.ss_quantity) > ( SELECT COALESCE(SUM(ss2.ss_quantity), 0) FROM store_sales ss2 JOIN date_dim d2 ON ss2.ss_sold_date_sk = d2.d_date_sk WHERE ss2.ss_store_sk = s.s_store_sk AND d2.d_year = 2000 ) UNION SELECT s.s_store_id FROM catalog_sales cs JOIN store s ON cs.cs_call_center_sk = s.s_store_sk JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001 AND i.i_current_price > 58 AND i.i_color IN ('cyan', 'peach', 'blush', 'frosted', 'powder', 'orange') GROUP BY s.s_store_id HAVING SUM(cs.cs_quantity) > ( SELECT COALESCE(SUM(cs2.cs_quantity), 0) FROM catalog_sales cs2 JOIN date_dim d2 ON cs2.cs_sold_date_sk = d2.d_date_sk WHERE cs2.cs_call_center_sk = s.s_store_sk AND d2.d_year = 2000 ) UNION SELECT s.s_store_id FROM web_sales ws JOIN store s ON ws.ws_web_site_sk = s.s_store_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_year = 2001 AND i.i_current_price > 58 AND i.i_color IN ('cyan', 'peach', 'blush', 'frosted', 'powder', 'orange') GROUP BY s.s_store_id HAVING SUM(ws.ws_quantity) > ( SELECT COALESCE(SUM(ws2.ws_quantity), 0) FROM web_sales ws2 JOIN date_dim d2 ON ws2.ws_sold_date_sk = d2.d_date_sk WHERE ws2.ws_web_site_sk = s.s_store_sk AND d2.d_year = 2000 );
