SELECT s.s_store_id FROM store s JOIN store_sales ss ON s.s_store_sk = ss.ss_store_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1999 AND i.i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i.i_current_price > 64 GROUP BY s.s_store_id HAVING SUM(ss.ss_quantity) > ( SELECT COALESCE(SUM(ss2.ss_quantity), 0) FROM store_sales ss2 JOIN date_dim d2 ON ss2.ss_sold_date_sk = d2.d_date_sk WHERE ss2.ss_store_sk = s.s_store_sk AND d2.d_year = 1998 );
