SELECT c.c_name AS customer_name, c.c_address AS customer_address, n.n_name AS customer_nation, c.c_phone AS customer_phone, c.c_acctbal AS customer_account_balance, c.c_comment AS customer_comment, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_lost FROM customer c JOIN orders o ON c.c_custkey = o.o_custkey JOIN lineitem l ON o.o_orderkey = l.l_orderkey JOIN nation n ON c.c_nationkey = n.n_nationkey WHERE l.l_returnflag = 'R' AND o.o_orderdate BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY c.c_custkey, c.c_name, c.c_address, n.n_name, c.c_phone, c.c_acctbal, c.c_comment ORDER BY revenue_lost DESC LIMIT 20;
