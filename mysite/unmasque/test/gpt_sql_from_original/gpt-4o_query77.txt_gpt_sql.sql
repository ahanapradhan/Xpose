SELECT 'Catalog' AS channel, cs.cs_call_center_sk AS location_id, SUM(cs.cs_ext_sales_price) AS total_sales, SUM(cr.cr_return_amount) AS total_returns, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk LEFT JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk AND cs.cs_call_center_sk = cr.cr_call_center_sk WHERE dd.d_date BETWEEN '2023-01-01' AND '2023-01-30' GROUP BY cs.cs_call_center_sk UNION ALL SELECT 'Store' AS channel, ss.ss_store_sk AS location_id, SUM(ss.ss_ext_sales_price) AS total_sales, SUM(sr.sr_return_amt) AS total_returns, SUM(ss.ss_net_profit) AS total_profit FROM store_sales ss JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk LEFT JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_store_sk = sr.sr_store_sk WHERE dd.d_date BETWEEN '2023-01-01' AND '2023-01-30' GROUP BY ss.ss_store_sk UNION ALL SELECT 'Web' AS channel, ws.ws_web_site_sk AS location_id, SUM(ws.ws_ext_sales_price) AS total_sales, SUM(wr.wr_return_amt) AS total_returns, SUM(ws.ws_net_profit) AS total_profit FROM web_sales ws JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk LEFT JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk AND ws.ws_web_site_sk = wr.wr_web_page_sk WHERE dd.d_date BETWEEN '2023-01-01' AND '2023-01-30' GROUP BY ws.ws_web_site_sk;
