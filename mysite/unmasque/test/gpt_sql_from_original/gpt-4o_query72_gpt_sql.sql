SELECT i.i_item_id, w.w_warehouse_id, d.d_week_seq, COUNT(CASE WHEN cs.cs_promo_sk IS NOT NULL THEN 1 END) AS sales_with_promotion, COUNT(CASE WHEN cs.cs_promo_sk IS NULL THEN 1 END) AS sales_without_promotion FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk GROUP BY i.i_item_id, w.w_warehouse_id, d.d_week_seq;
