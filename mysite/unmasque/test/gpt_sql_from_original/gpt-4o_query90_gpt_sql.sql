SELECT COALESCE(SUM(CASE WHEN t_morning.t_hour = 8 THEN ws_morning.ws_quantity ELSE 0 END), 0) / NULLIF(COALESCE(SUM(CASE WHEN t_evening.t_hour = 19 THEN ws_evening.ws_quantity ELSE 0 END), 0), 0) AS ratio FROM web_sales ws_morning JOIN time_dim t_morning ON ws_morning.ws_sold_time_sk = t_morning.t_time_sk JOIN web_page wp_morning ON ws_morning.ws_web_page_sk = wp_morning.wp_web_page_sk JOIN customer_demographics cd_morning ON ws_morning.ws_bill_cdemo_sk = cd_morning.cd_demo_sk JOIN web_sales ws_evening ON ws_morning.ws_order_number = ws_evening.ws_order_number JOIN time_dim t_evening ON ws_evening.ws_sold_time_sk = t_evening.t_time_sk JOIN web_page wp_evening ON ws_evening.ws_web_page_sk = wp_evening.wp_web_page_sk JOIN customer_demographics cd_evening ON ws_evening.ws_bill_cdemo_sk = cd_evening.cd_demo_sk WHERE cd_morning.cd_dep_count = 3 AND cd_evening.cd_dep_count = 3 AND wp_morning.wp_char_count > 1000 AND wp_evening.wp_char_count > 1000 AND t_morning.t_hour = 8 AND t_evening.t_hour = 19;
