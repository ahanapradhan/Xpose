SELECT COALESCE(SUM(CASE WHEN t_hour BETWEEN 8 AND 9 THEN ws_quantity ELSE 0 END), 0) / NULLIF(COALESCE(SUM(CASE WHEN t_hour BETWEEN 19 AND 20 THEN ws_quantity ELSE 0 END), 0), 0) AS ratio FROM web_sales JOIN time_dim ON ws_sold_time_sk = t_time_sk JOIN customer_demographics ON ws_bill_cdemo_sk = cd_demo_sk JOIN web_page ON ws_web_page_sk = wp_web_page_sk WHERE cd_dep_count = 8 AND wp_char_count > 1000;
