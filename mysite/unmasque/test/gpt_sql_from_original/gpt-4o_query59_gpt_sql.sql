SELECT s.s_store_id, d.d_day_name, SUM(CASE WHEN d.d_year = 2022 THEN ss.ss_net_paid ELSE 0 END) AS sales_2022, SUM(CASE WHEN d.d_year = 2023 THEN ss.ss_net_paid ELSE 0 END) AS sales_2023, SUM(CASE WHEN d.d_year = 2023 THEN ss.ss_net_paid ELSE 0 END) - SUM(CASE WHEN d.d_year = 2022 THEN ss.ss_net_paid ELSE 0 END) AS sales_increase FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE d.d_year IN (2022, 2023) GROUP BY s.s_store_id, d.d_day_name ORDER BY s.s_store_id, d.d_day_name;
