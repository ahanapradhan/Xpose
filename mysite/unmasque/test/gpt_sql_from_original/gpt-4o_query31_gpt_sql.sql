SELECT DISTINCT ca.ca_county FROM customer_address ca JOIN store_sales ss ON ca.ca_address_sk = ss.ss_addr_sk JOIN web_sales ws ON ca.ca_address_sk = ws.ws_bill_addr_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk AND ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_year = 2023 GROUP BY ca.ca_county, d.d_quarter_seq HAVING COUNT(DISTINCT d.d_quarter_seq) = 3 AND SUM(CASE WHEN d.d_quarter_seq = 1 THEN ws.ws_net_paid ELSE 0 END) / NULLIF(SUM(CASE WHEN d.d_quarter_seq = 1 THEN ss.ss_net_paid ELSE 0 END), 0) > 1 AND SUM(CASE WHEN d.d_quarter_seq = 2 THEN ws.ws_net_paid ELSE 0 END) / NULLIF(SUM(CASE WHEN d.d_quarter_seq = 2 THEN ss.ss_net_paid ELSE 0 END), 0) > 1 AND SUM(CASE WHEN d.d_quarter_seq = 3 THEN ws.ws_net_paid ELSE 0 END) / NULLIF(SUM(CASE WHEN d.d_quarter_seq = 3 THEN ss.ss_net_paid ELSE 0 END), 0) > 1;
