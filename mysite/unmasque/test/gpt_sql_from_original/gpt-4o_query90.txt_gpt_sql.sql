SELECT COALESCE(SUM(CASE WHEN t_morning.t_hour = 8 THEN ws_morning.ws_quantity ELSE 0 END), 0) / NULLIF(COALESCE(SUM(CASE WHEN t_evening.t_hour = 19 THEN ws_evening.ws_quantity ELSE 0 END), 0), 0) AS ratio FROM web_sales ws_morning JOIN time_dim t_morning ON ws_morning.ws_sold_time_sk = t_morning.t_time_sk JOIN web_sales ws_evening ON ws_morning.ws_order_number = ws_evening.ws_order_number JOIN time_dim t_evening ON ws_evening.ws_sold_time_sk = t_evening.t_time_sk JOIN customer_demographics cd ON ws_morning.ws_bill_cdemo_sk = cd.cd_demo_sk JOIN web_page wp ON ws_morning.ws_web_page_sk = wp.wp_web_page_sk WHERE cd.cd_dep_count = :specified_number_of_dependents AND wp.wp_char_count > :high_content_threshold;
