SELECT i.i_item_id, i.i_class, SUM(ws.ws_ext_sales_price) / SUM(SUM(ws.ws_ext_sales_price)) OVER (PARTITION BY i.i_class) AS revenue_ratio FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE i.i_category IN ('Sports', 'Books', 'Home') AND d.d_date BETWEEN '1999-02-22' AND '1999-03-24' GROUP BY i.i_item_id, i.i_class;
