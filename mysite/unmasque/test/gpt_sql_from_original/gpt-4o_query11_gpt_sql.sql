SELECT c.c_customer_id FROM customer c JOIN web_sales ws1 ON c.c_customer_sk = ws1.ws_bill_customer_sk JOIN date_dim d1 ON ws1.ws_sold_date_sk = d1.d_date_sk JOIN web_sales ws2 ON c.c_customer_sk = ws2.ws_bill_customer_sk JOIN date_dim d2 ON ws2.ws_sold_date_sk = d2.d_date_sk JOIN store_sales ss1 ON c.c_customer_sk = ss1.ss_customer_sk JOIN date_dim d3 ON ss1.ss_sold_date_sk = d3.d_date_sk JOIN store_sales ss2 ON c.c_customer_sk = ss2.ss_customer_sk JOIN date_dim d4 ON ss2.ss_sold_date_sk = d4.d_date_sk WHERE d1.d_year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND d2.d_year = EXTRACT(YEAR FROM CURRENT_DATE) AND d3.d_year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 AND d4.d_year = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY c.c_customer_id HAVING SUM(CASE WHEN d2.d_year = EXTRACT(YEAR FROM CURRENT_DATE) THEN ws2.ws_net_paid ELSE 0 END) - SUM(CASE WHEN d1.d_year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 THEN ws1.ws_net_paid ELSE 0 END) > SUM(CASE WHEN d4.d_year = EXTRACT(YEAR FROM CURRENT_DATE) THEN ss2.ss_net_paid ELSE 0 END) - SUM(CASE WHEN d3.d_year = EXTRACT(YEAR FROM CURRENT_DATE) - 1 THEN ss1.ss_net_paid ELSE 0 END);
