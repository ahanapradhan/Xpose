SELECT AVG(ss_quantity) AS avg_quantity, AVG(ss_list_price) AS avg_list_price, AVG(ss_sales_price) AS avg_sales_price, AVG(ss_coupon_amt) AS avg_coupon_amount, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_demo_sk FROM store_sales ss JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk WHERE ca.ca_state IN ('CA', 'TX', 'NY', 'FL', 'IL', 'PA') AND dd.d_year = 2022 GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_demo_sk;
