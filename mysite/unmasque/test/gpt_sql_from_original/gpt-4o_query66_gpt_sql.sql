SELECT d.d_month_seq, w.w_warehouse_name, SUM(ws.ws_ext_sales_price) AS web_sales, SUM(cs.cs_sales_price) AS catalog_sales, SUM(ws.ws_net_paid) AS web_profit, SUM(cs.cs_net_paid_inc_tax) AS catalog_profit FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN time_dim t ON ws.ws_sold_time_sk = t.t_time_sk JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk JOIN catalog_sales cs ON cs.cs_sold_date_sk = d.d_date_sk AND cs.cs_sold_time_sk = t.t_time_sk AND cs.cs_warehouse_sk = w.w_warehouse_sk WHERE d.d_year = 2001 AND t.t_time BETWEEN 30838 AND 30838 + 28800 GROUP BY d.d_month_seq, w.w_warehouse_name ORDER BY d.d_month_seq, w.w_warehouse_name;
