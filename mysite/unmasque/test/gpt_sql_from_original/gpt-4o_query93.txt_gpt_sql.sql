SELECT c.c_customer_id, COALESCE(SUM(cs.cs_net_paid), 0) + COALESCE(SUM(ss.ss_net_paid), 0) + COALESCE(SUM(ws.ws_net_paid), 0) - COALESCE(SUM(cr.cr_return_amount), 0) - COALESCE(SUM(sr.sr_return_amt), 0) - COALESCE(SUM(wr.wr_return_amt), 0) AS total_net_cost FROM customer c LEFT JOIN catalog_sales cs ON c.c_customer_sk = cs.cs_bill_customer_sk LEFT JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN catalog_returns cr ON c.c_customer_sk = cr.cr_refunded_customer_sk LEFT JOIN store_returns sr ON c.c_customer_sk = sr.sr_customer_sk LEFT JOIN web_returns wr ON c.c_customer_sk = wr.wr_refunded_customer_sk LEFT JOIN reason r_cr ON cr.cr_reason_sk = r_cr.r_reason_sk LEFT JOIN reason r_sr ON sr.sr_reason_sk = r_sr.r_reason_sk LEFT JOIN reason r_wr ON wr.wr_reason_sk = r_wr.r_reason_sk WHERE r_cr.r_reason_id = 'given_reason_id' OR r_sr.r_reason_id = 'given_reason_id' OR r_wr.r_reason_id = 'given_reason_id' GROUP BY c.c_customer_id;
