SELECT n.n_name AS nation, EXTRACT(YEAR FROM o.o_orderdate) AS year, SUM((l.l_extendedprice * (1 - l.l_discount)) - (ps.ps_supplycost * l.l_quantity)) AS profit FROM nation n JOIN supplier s ON n.n_nationkey = s.s_nationkey JOIN partsupp ps ON s.s_suppkey = ps.ps_suppkey JOIN part p ON ps.ps_partkey = p.p_partkey JOIN lineitem l ON p.p_partkey = l.l_partkey AND s.s_suppkey = l.l_suppkey JOIN orders o ON l.l_orderkey = o.o_orderkey WHERE p.p_name LIKE '%specified_substring%' GROUP BY n.n_name, EXTRACT(YEAR FROM o.o_orderdate) ORDER BY n.n_name ASC, year DESC;
