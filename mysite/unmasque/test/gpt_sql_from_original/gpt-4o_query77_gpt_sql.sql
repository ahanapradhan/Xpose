SELECT 'Catalog' AS channel, cr.cr_catalog_page_sk AS location_id, SUM(cs.cs_ext_sales_price) AS total_sales, SUM(cr.cr_return_amount) AS total_returns, SUM(cs.cs_net_profit) AS total_profit FROM catalog_sales cs JOIN catalog_returns cr ON cs.cs_order_number = cr.cr_order_number JOIN date_dim dd ON cs.cs_sold_date_sk = dd.d_date_sk WHERE dd.d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY cr.cr_catalog_page_sk UNION ALL SELECT 'Store' AS channel, sr.sr_store_sk AS location_id, SUM(ss.ss_ext_sales_price) AS total_sales, SUM(sr.sr_return_amt) AS total_returns, SUM(ss.ss_net_profit) AS total_profit FROM store_sales ss JOIN store_returns sr ON ss.ss_ticket_number = sr.sr_ticket_number JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk WHERE dd.d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY sr.sr_store_sk UNION ALL SELECT 'Web' AS channel, wr.wr_web_page_sk AS location_id, SUM(ws.ws_ext_sales_price) AS total_sales, SUM(wr.wr_return_amt) AS total_returns, SUM(ws.ws_net_profit) AS total_profit FROM web_sales ws JOIN web_returns wr ON ws.ws_order_number = wr.wr_order_number JOIN date_dim dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE dd.d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY wr.wr_web_page_sk;
