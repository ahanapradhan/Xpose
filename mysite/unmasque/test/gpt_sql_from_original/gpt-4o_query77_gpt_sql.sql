SELECT 'Store' AS channel, s_store_id AS channel_location_id, SUM(ss_ext_sales_price) AS total_sales, SUM(sr_return_amt) AS total_returns, SUM(ss_net_profit) AS total_profit FROM store_sales JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY channel, channel_location_id UNION ALL SELECT 'Catalog' AS channel, cp_catalog_page_id AS channel_location_id, SUM(cs_ext_sales_price) AS total_sales, SUM(cr_return_amount) AS total_returns, SUM(cs_net_profit) AS total_profit FROM catalog_sales JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk WHERE d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY channel, channel_location_id UNION ALL SELECT 'Web' AS channel, wp_web_page_id AS channel_location_id, SUM(ws_ext_sales_price) AS total_sales, SUM(wr_return_amt) AS total_returns, SUM(ws_net_profit) AS total_profit FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN web_page ON ws_web_page_sk = wp_web_page_sk WHERE d_date BETWEEN '2000-08-23' AND '2000-09-21' GROUP BY channel, channel_location_id;
